;/* current version is v1.0.12 */
!function (e, n) {
    "object" == typeof exports && "undefined" != typeof module ? module.exports = n() : "function" == typeof define && define.amd ? define(n) : e.iLoginComp = n()
}(this, function () {
    "use strict";
    var s, e, o = Object.assign || function (e) {
        for (var n, o = 1, t = arguments.length; o < t; o++) for (var i in n = arguments[o]) Object.prototype.hasOwnProperty.call(n, i) && (e[i] = n[i]);
        return e
    };
    (e = s || (s = {})).CANCEL_LOGIN = "cancelLogin", e.COMP_INNER = "iLoginCompInner", e.CODE_ID = "sendCodeBtn", e.LOGIN_ID = "iloginBtn", e.PHONE_NUM_INPUT_ID = "phoneNumInput", e.CODE_INPUT_ID = "codeInput", e.TIP_ID = "iLoginCompShowTip", e.MASK_ID = "iLoginCompMask", e.YODA_SMS_VERIFY = "smdcodeYodaRoot", e.YODA_SEC_VERIFY = "secYodaRoot", e.MODEL_ID = "iLoginCompModel";
    var n = {
        addHandler: function (e, n, o) {
            switch (n) {
                case"tap":
                    this.touch[n].addHandler(e, o);
                    break;
                default:
                    e.addEventListener(n, o, !1)
            }
        }, removeHandler: function (e, n, o) {
            switch (n) {
                case"tap":
                    this.touch[n].removeHandler(e, n, o);
                    break;
                default:
                    e.removeEventListener(n, o, !1)
            }
        }, touch: {
            tap: {
                addHandler: function (e, r) {
                    var o = null, t = null, a = {}, s = null;
                    e.addEventListener("touchstart", this.onTouchStart = function (e) {
                        var n = e.touches[0];
                        o = Date.now(), t = o - (a.last || o), clearTimeout(s), 0 < t && t <= 250 && (a.isDoubleTap = !0), a.last = o, this.startTx = n.clientX, this.startTy = n.clientY
                    }, !1), e.addEventListener("touchend", this.onTouchEnd = function (e) {
                        var n = this;
                        e.preventDefault();
                        var o = e.changedTouches[0], t = o.clientX, i = o.clientY;
                        return Math.abs(this.startTx - t) < 6 && Math.abs(this.startTy - i) < 6 ? a.isDoubleTap ? (a.isDoubleTap = !1, this.startTx = null, this.startTy = null, i = t = null, !1) : void (s = setTimeout(function () {
                            r(e), s = null, n.startTx = null, n.startTy = null, i = t = null, a = {}
                        }, 250)) : (e.preventDefault(), a = {}, this.startTx = null, this.startTy = null, i = t = null, !1)
                    }, !1)
                }, removeHandler: function (e) {
                    var n = this.onTouchStart, o = this.onTouchEnd;
                    e.removeEventListener("touchstart", n, !1), e.removeEventListener("touchend", o, !1)
                }
            }
        }, getEvent: function (e) {
            return e
        }, getTarget: function (e) {
            return e.target
        }, preventDefault: function (e) {
            e.preventDefault()
        }, stopPropagation: function (e) {
            e.stopPropagation()
        }, getCharCode: function (e) {
            return e.keyCode
        }
    }, t = function (e, n) {
        return void 0 === n && (n = ""), !!~(e.className || "").split(/\s+/g).indexOf(n.trim())
    }, i = function (e, n) {
        if (void 0 === n && (n = ""), 1 === e.nodeType) {
            var o = n.split(/\s+/g), t = e.className, i = t;
            t ? (o.forEach(function (e) {
                ~t.indexOf(" " + e + " ") || (i += " " + e)
            }), e.className = i) : e.className = n
        }
    }, r = function (e, n) {
        if (1 === e.nodeType) if (n) {
            var o = n.split(/\s+/g), t = e.className;
            o.forEach(function (e) {
                t = t.replace(e, " ")
            }), e.className = t.trim()
        } else e.className = ""
    };
    var a = setTimeout;

    function l() {
    }

    function u(e) {
        if (!(this instanceof u)) throw new TypeError("Promises must be constructed via new");
        if ("function" != typeof e) throw new TypeError("not a function");
        this._state = 0, this._handled = !1, this._value = void 0, this._deferreds = [], g(e, this)
    }

    function c(o, t) {
        for (; 3 === o._state;) o = o._value;
        0 !== o._state ? (o._handled = !0, u._immediateFn(function () {
            var e = 1 === o._state ? t.onFulfilled : t.onRejected;
            if (null !== e) {
                var n;
                try {
                    n = e(o._value)
                } catch (e) {
                    return void p(t.promise, e)
                }
                d(t.promise, n)
            } else (1 === o._state ? d : p)(t.promise, o._value)
        })) : o._deferreds.push(t)
    }

    function d(n, e) {
        try {
            if (e === n) throw new TypeError("A promise cannot be resolved with itself.");
            if (e && ("object" == typeof e || "function" == typeof e)) {
                var o = e.then;
                if (e instanceof u) return n._state = 3, n._value = e, void f(n);
                if ("function" == typeof o) return void g((t = o, i = e, function () {
                    t.apply(i, arguments)
                }), n)
            }
            n._state = 1, n._value = e, f(n)
        } catch (e) {
            p(n, e)
        }
        var t, i
    }

    function p(e, n) {
        e._state = 2, e._value = n, f(e)
    }

    function f(e) {
        2 === e._state && 0 === e._deferreds.length && u._immediateFn(function () {
            e._handled || u._unhandledRejectionFn(e._value)
        });
        for (var n = 0, o = e._deferreds.length; n < o; n++) c(e, e._deferreds[n]);
        e._deferreds = null
    }

    function m(e, n, o) {
        this.onFulfilled = "function" == typeof e ? e : null, this.onRejected = "function" == typeof n ? n : null, this.promise = o
    }

    function g(e, n) {
        var o = !1;
        try {
            e(function (e) {
                o || (o = !0, d(n, e))
            }, function (e) {
                o || (o = !0, p(n, e))
            })
        } catch (e) {
            if (o) return;
            o = !0, p(n, e)
        }
    }

    u.prototype.catch = function (e) {
        return this.then(null, e)
    }, u.prototype.then = function (e, n) {
        var o = new this.constructor(l);
        return c(this, new m(e, n, o)), o
    }, u.prototype.finally = function (n) {
        var o = this.constructor;
        return this.then(function (e) {
            return o.resolve(n()).then(function () {
                return e
            })
        }, function (e) {
            return o.resolve(n()).then(function () {
                return o.reject(e)
            })
        })
    }, u.all = function (n) {
        return new u(function (t, i) {
            if (!n || void 0 === n.length) throw new TypeError("Promise.all accepts an array");
            var r = Array.prototype.slice.call(n);
            if (0 === r.length) return t([]);
            var a = r.length;

            function s(n, e) {
                try {
                    if (e && ("object" == typeof e || "function" == typeof e)) {
                        var o = e.then;
                        if ("function" == typeof o) return void o.call(e, function (e) {
                            s(n, e)
                        }, i)
                    }
                    r[n] = e, 0 == --a && t(r)
                } catch (e) {
                    i(e)
                }
            }

            for (var e = 0; e < r.length; e++) s(e, r[e])
        })
    }, u.resolve = function (n) {
        return n && "object" == typeof n && n.constructor === u ? n : new u(function (e) {
            e(n)
        })
    }, u.reject = function (o) {
        return new u(function (e, n) {
            n(o)
        })
    }, u.race = function (i) {
        return new u(function (e, n) {
            for (var o = 0, t = i.length; o < t; o++) i[o].then(e, n)
        })
    }, u._immediateFn = "function" == typeof setImmediate && function (e) {
        setImmediate(e)
    } || function (e) {
        a(e, 0)
    }, u._unhandledRejectionFn = function (e) {
        "undefined" != typeof console && console && console.warn("Possible Unhandled Promise Rejection:", e)
    };
    var h = null, v = function () {
        clearInterval(h)
    }, y = function (t, i) {
        return new u(function (e, n) {
            clearInterval(h), h = null;
            var o = 0;
            i.innerHTML = t - o + "", h = setInterval(function () {
                o += 1, i.innerHTML = t - o + "", o === t && (v(), e())
            }, 1e3)
        })
    };

    function b(r, a, s, l, c) {
        void 0 === c && (c = !1);
        try {
            return l = l || {}, new u(function (n, o) {
                var t = new XMLHttpRequest;
                if ("withCredentials" in t) {
                    if (l["Content-Type"] = "application/x-www-form-urlencoded", t.withCredentials = c, t.open(a, r, !0), t.timeout = 5e3, l) for (var e in l) l.hasOwnProperty(e) && t.setRequestHeader(e, l[e]);
                    t.onload = function () {
                        if (4 === t.readyState) if (200 <= t.status && t.status < 300) {
                            try {
                                var e = JSON.parse(t.response);
                                n(e)
                            } catch (e) {
                                n(t.response)
                            }
                            t = null
                        } else o(new Error(t.statusText)), t = null
                    }, t.ontimeout = function (e) {
                        o(new Error("请求超时:" + r)), t = null
                    }, t.onerror = function () {
                        o(new Error(t.statusText)), t = null
                    }, t.send(s)
                } else if (window.XDomainRequest) {
                    var i = new XDomainRequest;
                    i.open(a, r), i.onprogress = function () {
                    }, i.ontimeout = function () {
                        o(new Error("请求超时:" + r)), i = null
                    }, i.onerror = function () {
                        console.error("xdr onerror"), o(new Error("xdr onerror")), i = null
                    }, i.onload = function () {
                        try {
                            n(JSON.parse(i.responseText))
                        } catch (e) {
                            console.error(e), n(i.responseText)
                        }
                    }, setTimeout(function () {
                        i.send(s)
                    }, 0)
                } else o(new Error("创建xhr对象失败")), t = null
            })
        } catch (e) {
            throw console.log(e), new Error("request error")
        }
    }

    function C(e, n, o) {
        return void 0 === n && (n = null), void 0 === o && (o = !1), b(e, "GET", null, n, o)
    }

    function _(e, n, o, t) {
        if ("object" == typeof n && !(n instanceof String || window.FormData && n instanceof window.FormData)) {
            var i = [];
            for (var r in n) i.push(encodeURIComponent(r) + "=" + encodeURIComponent(n[r]));
            n = i.join("&")
        }
        return b(e, "POST", n, o, t)
    }

    var w = function (e) {
        if (null == e) throw TypeError("Can't call method on  " + e);
        return e
    }, k = function (e) {
        return Object(w(e))
    }, x = {}.hasOwnProperty, I = function (e, n) {
        return x.call(e, n)
    }, L = {}.toString, T = Object("z").propertyIsEnumerable(0) ? Object : function (e) {
        return "String" == (n = e, L.call(n).slice(8, -1)) ? e.split("") : Object(e);
        var n
    }, E = function (e) {
        return T(w(e))
    }, N = Math.ceil, O = Math.floor, S = function (e) {
        return isNaN(e = +e) ? 0 : (0 < e ? O : N)(e)
    }, P = Math.min, D = Math.max, M = Math.min;

    function j(e, n) {
        return e(n = {exports: {}}, n.exports), n.exports
    }

    var F, U, A = j(function (e) {
            var n = e.exports = {version: "2.5.7"};
            "number" == typeof __e && (__e = n)
        }), R = (A.version, j(function (e) {
            var n = e.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self && self.Math == Math ? self : Function("return this")();
            "number" == typeof __g && (__g = n)
        })), B = j(function (e) {
            var n = "__core-js_shared__", o = R[n] || (R[n] = {});
            (e.exports = function (e, n) {
                return o[e] || (o[e] = void 0 !== n ? n : {})
            })("versions", []).push({version: A.version, mode: "global", copyright: "© 2018 Denis Pushkarev (zloirock.ru)"})
        }), H = 0, Y = Math.random(), z = function (e) {
            return "Symbol(".concat(void 0 === e ? "" : e, ")_", (++H + Y).toString(36))
        }, q = B("keys"), V = (F = !1, function (e, n, o) {
            var t, i, r, a, s = E(e), l = 0 < (t = s.length) ? P(S(t), 9007199254740991) : 0,
                c = (r = l, (i = S(i = o)) < 0 ? D(i + r, 0) : M(i, r));
            if (F && n != n) {
                for (; c < l;) if ((a = s[c++]) != a) return !0
            } else for (; c < l; c++) if ((F || c in s) && s[c] === n) return F || c || 0;
            return !F && -1
        }), G = q[U = "IE_PROTO"] || (q[U] = z(U)),
        X = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),
        K = Object.keys || function (e) {
            return function (e, n) {
                var o, t = E(e), i = 0, r = [];
                for (o in t) o != G && I(t, o) && r.push(o);
                for (; n.length > i;) I(t, o = n[i++]) && (~V(r, o) || r.push(o));
                return r
            }(e, X)
        }, Q = function (e) {
            return "object" == typeof e ? null !== e : "function" == typeof e
        }, J = function (e) {
            if (!Q(e)) throw TypeError(e + " is not an object!");
            return e
        }, W = function (e) {
            try {
                return !!e()
            } catch (e) {
                return !0
            }
        }, $ = !W(function () {
            return 7 != Object.defineProperty({}, "a", {
                get: function () {
                    return 7
                }
            }).a
        }), Z = R.document, ee = Q(Z) && Q(Z.createElement), ne = !$ && !W(function () {
            return 7 != Object.defineProperty((e = "div", ee ? Z.createElement(e) : {}), "a", {
                get: function () {
                    return 7
                }
            }).a;
            var e
        }), oe = Object.defineProperty, te = {
            f: $ ? Object.defineProperty : function (e, n, o) {
                if (J(e), n = function (e, n) {
                    if (!Q(e)) return e;
                    var o, t;
                    if (n && "function" == typeof (o = e.toString) && !Q(t = o.call(e))) return t;
                    if ("function" == typeof (o = e.valueOf) && !Q(t = o.call(e))) return t;
                    if (!n && "function" == typeof (o = e.toString) && !Q(t = o.call(e))) return t;
                    throw TypeError("Can't convert object to primitive value")
                }(n, !0), J(o), ne) try {
                    return oe(e, n, o)
                } catch (e) {
                }
                if ("get" in o || "set" in o) throw TypeError("Accessors not supported!");
                return "value" in o && (e[n] = o.value), e
            }
        }, ie = $ ? function (e, n, o) {
            return te.f(e, n, {enumerable: !((t = 1) & t), configurable: !(2 & t), writable: !(4 & t), value: o});
            var t
        } : function (e, n, o) {
            return e[n] = o, e
        }, re = j(function (e) {
            var r = z("src"), n = "toString", o = Function[n], a = ("" + o).split(n);
            A.inspectSource = function (e) {
                return o.call(e)
            }, (e.exports = function (e, n, o, t) {
                var i = "function" == typeof o;
                i && (I(o, "name") || ie(o, "name", n)), e[n] !== o && (i && (I(o, r) || ie(o, r, e[n] ? "" + e[n] : a.join(String(n)))), e === R ? e[n] = o : t ? e[n] ? e[n] = o : ie(e, n, o) : (delete e[n], ie(e, n, o)))
            })(Function.prototype, n, function () {
                return "function" == typeof this && this[r] || o.call(this)
            })
        }), ae = function (t, i, e) {
            if (function (e) {
                if ("function" != typeof e) throw TypeError(e + " is not a function!")
            }(t), void 0 === i) return t;
            switch (e) {
                case 1:
                    return function (e) {
                        return t.call(i, e)
                    };
                case 2:
                    return function (e, n) {
                        return t.call(i, e, n)
                    };
                case 3:
                    return function (e, n, o) {
                        return t.call(i, e, n, o)
                    }
            }
            return function () {
                return t.apply(i, arguments)
            }
        }, se = "prototype", le = function (e, n, o) {
            var t, i, r, a, s = e & le.F, l = e & le.G, c = e & le.S, u = e & le.P, d = e & le.B,
                p = l ? R : c ? R[n] || (R[n] = {}) : (R[n] || {})[se], f = l ? A : A[n] || (A[n] = {}),
                m = f[se] || (f[se] = {});
            for (t in l && (o = n), o) r = ((i = !s && p && void 0 !== p[t]) ? p : o)[t], a = d && i ? ae(r, R) : u && "function" == typeof r ? ae(Function.call, r) : r, p && re(p, t, r, e & le.U), f[t] != r && ie(f, t, a), u && m[t] != r && (m[t] = r)
        };
    R.core = A, le.F = 1, le.G = 2, le.S = 4, le.P = 8, le.B = 16, le.W = 32, le.U = 64, le.R = 128;
    var ce, ue, de, pe, fe = le;
    ce = "keys", ue = function () {
        return function (e) {
            return K(k(e))
        }
    }, de = (A.Object || {})[ce] || Object[ce], (pe = {})[ce] = ue(de), fe(fe.S + fe.F * W(function () {
        de(1)
    }), "Object", pe);
    var me = A.Object.keys;

    function ge(e) {
        return "string" == typeof e ? e : "number" == typeof e && isFinite(e) ? "" + e : "boolean" == typeof e ? e ? "true" : "false" : ""
    }

    function he(e, n) {
        var o = n || {}, t = o.sep, i = void 0 === t ? "&" : t, r = o.eq, a = void 0 === r ? "=" : r, s = o.encode,
            l = void 0 === s ? encodeURIComponent : s;
        if (null !== e && "object" == typeof e) {
            for (var c = me(e), u = c.length, d = u - 1, p = "", f = 0; f < u; ++f) {
                var m = c[f], g = e[m], h = l(ge(m)) + a;
                if (Array.isArray(g)) {
                    for (var v = g.length, y = v - 1, b = 0; b < v; ++b) p += h + l(ge(g[b])), b < y && (p += i);
                    v && f < d && (p += i)
                } else p += h + l(ge(g)), f < d && (p += i)
            }
            return p
        }
        return ""
    }

    var ve = {env: "", api: ""}, ye = function () {
            return ve.env
        }, be = {f: Object.getOwnPropertySymbols}, Ce = {f: {}.propertyIsEnumerable}, we = Object.assign,
        ke = !we || W(function () {
            var e = {}, n = {}, o = Symbol(), t = "abcdefghijklmnopqrst";
            return e[o] = 7, t.split("").forEach(function (e) {
                n[e] = e
            }), 7 != we({}, e)[o] || Object.keys(we({}, n)).join("") != t
        }) ? function (e, n) {
            for (var o = k(e), t = arguments.length, i = 1, r = be.f, a = Ce.f; i < t;) for (var s, l = T(arguments[i++]), c = r ? K(l).concat(r(l)) : K(l), u = c.length, d = 0; d < u;) a.call(l, s = c[d++]) && (o[s] = l[s]);
            return o
        } : we;
    fe(fe.S + fe.F, "Object", {assign: ke});
    var _e, xe, Ie = A.Object.assign, Le = {
        prod: {
            mobileloginapply: "https://passport.meituan.com/api/v3/account/mobileloginapply",
            mobilelogin: "https://passport.meituan.com/api/v3/account/mobilelogin",
            verifylogin: "https://passport.meituan.com/api/v1/account/verifylogin",
            h5loginapply: "https://open.meituan.com/thirdlogin/h5loginapply",
            h5login: "https://open.meituan.com/thirdlogin/h5login",
            h5auth: "https://open.meituan.com/thirdlogin/auth"
        },
        staging: {
            mobileloginapply: "//passport.wpt.st.sankuai.com/api/v3/account/mobileloginapply",
            mobilelogin: "//passport.wpt.st.sankuai.com/api/v3/account/mobilelogin",
            verifylogin: "//passport.wpt.st.sankuai.com/api/v1/account/verifylogin",
            h5loginapply: "//thirdlogin.wpt.st.sankuai.com/thirdlogin/h5loginapply",
            h5login: "//thirdlogin.wpt.st.sankuai.com/thirdlogin/h5login",
            h5auth: "//thirdlogin.wpt.st.sankuai.com/thirdlogin/auth"
        },
        dev: {
            mobileloginapply: "//passport.wpt.dev.sankuai.com/api/v3/account/mobileloginapply",
            mobilelogin: "//passport.wpt.dev.sankuai.com/api/v3/account/mobilelogin",
            verifylogin: "//passport.wpt.dev.sankuai.com/api/v1/account/verifylogin",
            h5loginapply: "//thirdlogin.wpt.dev.sankuai.com/thirdlogin/h5loginapply",
            h5login: "//thirdlogin.wpt.dev.sankuai.com/thirdlogin/h5login",
            h5auth: "//thirdlogin.wpt.dev.sankuai.com/thirdlogin/auth"
        },
        test: {
            mobileloginapply: "//passport.wpt.test.sankuai.com/api/v3/account/mobileloginapply",
            mobilelogin: "//passport.wpt.test.sankuai.com/api/v3/account/mobilelogin",
            verifylogin: "//passport.wpt.test.sankuai.com/api/v1/account/verifylogin",
            h5loginapply: "//thirdlogin.wpt.test.sankuai.com/thirdlogin/h5loginapply",
            h5login: "//thirdlogin.wpt.test.sankuai.com/thirdlogin/h5login",
            h5auth: "//thirdlogin.wpt.test.sankuai.com/thirdlogin/auth"
        }
    }, Te = function () {
        switch (ye()) {
            case"dev":
                return "//verify.inf.dev.meituan.com";
            case"test":
                return "//verify.inf.test.meituan.com";
            case"staging":
                return "//verify-test.meituan.com";
            default:
                return "https://verify.meituan.com"
        }
    }, Ee = function () {
        return Te() + "/v2/ext_api/page_data"
    }, Ne = {
        extraClass: "",
        loginBtnText: "登录",
        codePlaceholder: "请输入短信验证码",
        phoneNumPlaceholder: "请输入手机号",
        sendCodeText: "发送验证码",
        sendCodePos: 1,
        cancelBtnText: "取消",
        showCancel: !1
    }, Oe = {}, Se = function (e) {
        var n, o, t = e.env, i = void 0 === t ? "" : t, r = e.uiConfig, a = e.risk_platform, s = e.risk_partner,
            l = e.risk_app, c = e.risk_smsTemplateId, u = e.risk_smsPrefixId, d = e.uuid, p = void 0 === d ? "" : d,
            f = e.componentId, m = void 0 === f ? "iLoginComp" : f, g = e.api, h = void 0 === g ? "" : g,
            v = e.loginSource, y = void 0 === v ? 0 : v, b = e.campaignPlatform, C = e.allCampaignId,
            w = e.specialRiskCode, k = e.tokenVersion, _ = void 0 === k ? 1 : k, x = e.officialAccount,
            I = e.callbackUrl, L = void 0 === I ? window.location.href : I, T = e.callbackFailUrl,
            E = void 0 === T ? window.location.href : T, N = e.LONGITUDE, O = void 0 === N ? "" : N, S = e.LATITUDE,
            P = void 0 === S ? "" : S, D = e.isMobile, M = void 0 === D || D, j = e.phone_num;
        return Ie(Oe, {
            risk_platform: a,
            risk_partner: s,
            risk_app: l,
            risk_smsTemplateId: c,
            risk_smsPrefixId: u,
            uuid: p,
            loginSource: y,
            campaignPlatform: b,
            allCampaignId: C,
            tokenVersion: _,
            specialRiskCode: w,
            officialAccount: x,
            callbackUrl: L,
            callbackFailUrl: E,
            LONGITUDE: O,
            LATITUDE: P,
            isMobile: M,
            phone_num: (void 0 === j ? "" : j) + ""
        }), n = i, ve.env = n, "portm" === (o = h) || "" === o ? ve.api = o : console.error("api的值只支持portm和空字符串!"), {
            uiConfig: Ie({}, Ne, r),
            componentId: m
        }
    };
    (xe = _e || (_e = {})).loginApplyUrl = "mobileloginapply", xe.mobileLoginUrl = "mobilelogin", xe.verifyloginUrl = "verifylogin", xe.h5LoginApplyUrl = "h5loginapply", xe.h5loginUrl = "h5login", xe.h5authUrl = "h5auth";
    var Pe = function (e) {
        var n = Le[ye() || "prod"];
        return ("portm" === ve.api ? me(n).reduce(function (e, n) {
            return e[n] = "https://portal-portm.meituan.com/weapp/loginsdk/api/" + (ye() ? ye() + "/" : "") + n, e
        }, {}) : n)[e]
    }, De = j(function (e, n) {
        var o;
        o = function () {
            function g() {
                for (var e = 0, n = {}; e < arguments.length; e++) {
                    var o = arguments[e];
                    for (var t in o) n[t] = o[t]
                }
                return n
            }

            return function e(f) {
                function m(e, n, o) {
                    var t;
                    if ("undefined" != typeof document) {
                        if (1 < arguments.length) {
                            if ("number" == typeof (o = g({path: "/"}, m.defaults, o)).expires) {
                                var i = new Date;
                                i.setMilliseconds(i.getMilliseconds() + 864e5 * o.expires), o.expires = i
                            }
                            o.expires = o.expires ? o.expires.toUTCString() : "";
                            try {
                                t = JSON.stringify(n), /^[\{\[]/.test(t) && (n = t)
                            } catch (e) {
                            }
                            n = f.write ? f.write(n, e) : encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent), e = (e = (e = encodeURIComponent(String(e))).replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent)).replace(/[\(\)]/g, escape);
                            var r = "";
                            for (var a in o) o[a] && (r += "; " + a, !0 !== o[a] && (r += "=" + o[a]));
                            return document.cookie = e + "=" + n + r
                        }
                        e || (t = {});
                        for (var s = document.cookie ? document.cookie.split("; ") : [], l = /(%[0-9A-Z]{2})+/g, c = 0; c < s.length; c++) {
                            var u = s[c].split("="), d = u.slice(1).join("=");
                            this.json || '"' !== d.charAt(0) || (d = d.slice(1, -1));
                            try {
                                var p = u[0].replace(l, decodeURIComponent);
                                if (d = f.read ? f.read(d, p) : f(d, p) || d.replace(l, decodeURIComponent), this.json) try {
                                    d = JSON.parse(d)
                                } catch (e) {
                                }
                                if (e === p) {
                                    t = d;
                                    break
                                }
                                e || (t[p] = d)
                            } catch (e) {
                            }
                        }
                        return t
                    }
                }

                return (m.set = m).get = function (e) {
                    return m.call(m, e)
                }, m.getJSON = function () {
                    return m.apply({json: !0}, [].slice.call(arguments))
                }, m.defaults = {}, m.remove = function (e, n) {
                    m(e, "", g(n, {expires: -1}))
                }, m.withConverter = e, m
            }(function () {
            })
        }, e.exports = o()
    }), Me = De.get("iuuid") || "", je = function (e) {
        return e && "string" == typeof e && 0 < e.length
    }, Fe = function (e) {
        je(e) && (De.set("iuuid", e, {
            domain: ".meituan.com",
            expires: 730
        }), De.set("iuuid", e, {domain: ".sankuai.com", expires: 730}))
    }, Ue = function (n) {
        return C("https://portal-portm.meituan.com/weapp/loginsdk/api/uuid").then(function (e) {
            return e
        }).catch(function (e) {
            return 0 < n ? (console.log("获取uuid错误，请重试"), Ue(n - 1)) : ""
        })
    }, Ae = function (e, n) {
        return void 0 === n && (n = 1), je(e) ? (Fe(Me = e), u.resolve(Me)) : je(Me) ? (Fe(Me), u.resolve(Me)) : Ue(n).then(function (e) {
            return Fe(Me = e), Me
        })
    }, Re = function (o) {
        return void 0 === o && (o = {}), me(o).reduce(function (e, n) {
            return null != o[n] && (e[n] = o[n]), e
        }, {})
    }, Be = navigator.userAgent.toLocaleLowerCase(), He = function () {
        return -1 < Be.indexOf(" qq") && -1 === Be.indexOf("qqbrowser")
    }, Ye = function () {
        return -1 < Be.indexOf("micromessenger")
    }, ze = function (e) {
        var n = document.createElement("script");
        if (n.type = "text/javascript", n.async = e.async || !1, n.src = e.src, "afterbody" === e.position) {
            document.getElementsByTagName("body")[0].appendChild(n)
        } else {
            var o = document.getElementsByTagName("script")[0];
            if (o) o.parentNode.insertBefore(n, o); else document.getElementsByTagName("head")[0].appendChild(n)
        }
    }, qe = function (e) {
        return /^1[0-9]\d{9}$/.test(e)
    }, Ve = function (e) {
        e.style.display = "block"
    }, Ge = function (e) {
        e.style.display = "none"
    }, Xe = function (e) {
        e.yodaEle.style.display = "none", Ge(e.maskEle)
    }, Ke = function (e) {
        return Rohr_Opt && Rohr_Opt.reload ? Rohr_Opt.reload(e) : ""
    }, Qe = function (e, n) {
        var o, t = (o = e, Te() + "/v2/ext_api/" + o + "/info"), i = Ie(n, {_token: Ke(t)});
        return _(t + "?" + he(i), i).then(function (e) {
            return e
        })
    }, Je = function (e, n) {
        var o, t = (o = e, Te() + "/v2/ext_api/" + o + "/verify");
        return _(t + "?" + he(Ie(n, {_token: Ke(t)})), n).then(function (e) {
            return e
        })
    };

    function We(e) {
        if (0 === e.length) return [];
        if (1 === e.length) return [e.charCodeAt(0)];
        for (var n = [], o = 0; o < e.length; ++o) n[n.length] = e.charCodeAt(o);
        return n
    }

    var $e = [38], Ze = [61];

    function en(e, n, o) {
        var t = {};
        if ("string" != typeof e || 0 === e.length) return t;
        for (var i = n ? We(n + "") : $e, r = o ? We(o + "") : Ze, a = i.length, s = r.length, l = [], c = 0, u = 0, d = 0, p = "", f = "", m = 0; m < e.length; ++m) {
            var g = e.charCodeAt(m);
            if (g === i[u]) {
                if (++u === a) {
                    var h, v = m - u + 1;
                    if (d < s) {
                        if (!(c < v)) {
                            c = m + 1, u = d = 0;
                            continue
                        }
                        p += e.slice(c, v)
                    } else c < v && (f += e.slice(c, v));
                    if (-1 === l.indexOf(p)) t[p] = f, l[l.length] = p; else (h = t[p]).pop ? h[h.length] = f : t[p] = [h, f];
                    p = f = "", c = m + 1, u = d = 0
                }
            } else {
                if (u = 0, d < s) {
                    if (g === r[d]) {
                        if (++d === s) c < (v = m - d + 1) && (p += e.slice(c, v)), c = m + 1;
                        continue
                    }
                    if (d = 0, 43 === g) {
                        c < m && (p += e.slice(c, m)), p += " ", c = m + 1;
                        continue
                    }
                }
                43 === g && (c < m && (f += e.slice(c, m)), f += " ", c = m + 1)
            }
        }
        if (c < e.length) d < s ? p += e.slice(c) : u < a && (f += e.slice(c)); else if (0 === d) return t;
        -1 === l.indexOf(p) ? (t[p] = f, l[l.length] = p) : (h = t[p]).pop ? h[h.length] = f : t[p] = [h, f];
        return t
    }

    var nn, on, tn = {};
    (on = nn || (nn = {})).SEND_SMSCODE_CLICK = "sendSmscodeClick", on.LOGIN_CLICK = "loginClick", on.LOGIN_COMPLETE = "loginComplete", on.COMP_INITED = "compInited", on.CANCEL_CLICK = "cancelClick";
    var rn = function () {
        function e() {
            this._callbacks = {}
        }

        return e.prototype._emit = function (e, n) {
            var o = this, t = this._callbacks[e];
            t && t.forEach(function (e) {
                e && "function" == typeof e && e.call(o, n)
            })
        }, e.prototype.on = function (e, n) {
            this._callbacks[e] = this._callbacks[e] || [], this._callbacks[e].push(n)
        }, e.prototype.clean = function () {
            this._callbacks = {}
        }, e
    }(), an = {session: null}, sn = function () {
        return an.session
    };
    !function (e, n) {
        void 0 === n && (n = {});
        var o = n.insertAt;
        if (e && "undefined" != typeof document) {
            var t = document.head || document.getElementsByTagName("head")[0], i = document.createElement("style");
            i.type = "text/css", "top" === o && t.firstChild ? t.insertBefore(i, t.firstChild) : t.appendChild(i), i.styleSheet ? i.styleSheet.cssText = e : i.appendChild(document.createTextNode(e))
        }
    }("@media only screen and (min-width:320px){.fontSize{font-size:16px}}@media only screen and (min-width:480px){.fontSize{font-size:24px}}@media only screen and (min-width:560px){.fontSize{font-size:30px}}.mtfe-tip-mtfe-wrapper{display:none;position:absolute;width:70%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);top:9em;padding:.5em 1em;border-radius:.25em;background:rgba(0,0,0,.7);color:#fff;z-index:3;text-align:center}@media only screen and (min-width:320px){.mtfe-tip-mtfe-wrapper{font-size:16px}}@media only screen and (min-width:480px){.mtfe-tip-mtfe-wrapper{font-size:24px}}@media only screen and (min-width:560px){.mtfe-tip-mtfe-wrapper{font-size:30px}}.mtfe-model-mtfe-wrapper{display:none;position:absolute;width:80%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);top:9em;padding:.5em 0;border-radius:.25em;background:#fff;color:#fff;z-index:3;text-align:center}@media only screen and (min-width:320px){.mtfe-model-mtfe-wrapper{font-size:16px}}@media only screen and (min-width:480px){.mtfe-model-mtfe-wrapper{font-size:24px}}@media only screen and (min-width:560px){.mtfe-model-mtfe-wrapper{font-size:30px}}.mtfe-smscodeyoda-mtfe-wrapper{display:none;width:80%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);top:40%;position:absolute;z-index:2}.mtfe-mask-mtfe-wrapper{margin:0;padding:0;position:absolute;top:0;left:0;display:none;background:rgba(0,0,0,.6);width:100%;height:100%;z-index:1}.iLoginComp-wrapper{width:100%;padding:1.2em;-webkit-box-sizing:border-box;box-sizing:border-box}@media only screen and (min-width:320px){.iLoginComp-wrapper{font-size:16px}}@media only screen and (min-width:480px){.iLoginComp-wrapper{font-size:24px}}@media only screen and (min-width:560px){.iLoginComp-wrapper{font-size:30px}}.iLoginComp-phone-num-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around;border-bottom:1px solid #e5e5e5;padding-bottom:.6em}.iLoginComp-phone-num-input{-webkit-box-flex:1;-ms-flex:1;flex:1;border:0;min-width:0;-webkit-tap-highlight-color:rgba(0,0,0,0);font-size:1em}.iLoginComp-phone-num-input,.iLoginComp-phone-num-input:focus{outline:none;background-color:inherit}.iLoginComp-phone-num-input::-webkit-input-placeholder{color:#ccc}.iLoginComp-phone-num-input:-ms-input-placeholder,.iLoginComp-phone-num-input::-ms-input-placeholder{color:#ccc}.iLoginComp-phone-num-input::placeholder{color:#ccc}.iLoginComp-verify-code-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around;margin-top:1em;padding-bottom:.6em;border-bottom:1px solid #e5e5e5;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.iLoginComp-code-input{-webkit-box-flex:1;-ms-flex:1;flex:1;width:100%;border:0;min-width:0;-webkit-tap-highlight-color:rgba(0,0,0,0);font-size:1em}.iLoginComp-code-input,.iLoginComp-code-input:focus{outline:none;background-color:inherit}.iLoginComp-code-input::-webkit-input-placeholder{color:#ccc}.iLoginComp-code-input:-ms-input-placeholder,.iLoginComp-code-input::-ms-input-placeholder{color:#ccc}.iLoginComp-code-input::placeholder{color:#ccc}.iLogincomp-opbtn-wrapper{margin-top:2em}.iLoginComp-cancel-btn-wrapper,.iLoginComp-login-btn-wrapper{text-align:center;color:#999;background:#e5e5e5;height:2.8em;line-height:2.8em;border-radius:.3em;width:100%;display:block;border:none;cursor:pointer;font-size:1em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.iLoginComp-cancel-btn-wrapper:focus,.iLoginComp-login-btn-wrapper:focus{outline:0}.iLoginComp-login-btn-wrapper.iLogincomp-active{color:#fff;background:#06c1ae}.iLoginComp-send-verify-code-text{font-size:.8em;color:#999;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#dcdcdc;border:1px solid #dcdcdc;padding:.2em .5em;border-radius:.2em;-webkit-box-sizing:border-box;box-sizing:border-box;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0)}.iLoginComp-send-verify-code-text.iLogincomp-active{color:#06c1ae;border:1px solid #06c1ae;background:0}.iLogincomp-count-down{color:#999;background-color:#dcdcdc;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:2em}");
    var ln = new function () {
        var e, k = this;
        this.init = function (e) {
            var n = Se(e), o = n.uiConfig, t = n.componentId;
            k.uiConfig = o, ze({
                src: "https://s0.meituan.net/mxx/y/default.js",
                async: !1
            }), ze({src: "https://s0.meituan.net/mxx/yoda/yoda.seed.js", async: !0});
            var i, r, a = document.getElementById(t);
            a ? (a.style.visibility = "hidden", a.innerHTML = (i = o, r = Oe.phone_num, "\n    <div id=" + s.YODA_SEC_VERIFY + " class='mtfe-secyoda-mtfe-wrapper'></div>\n    <div id=" + s.YODA_SMS_VERIFY + " class='mtfe-smscodeyoda-mtfe-wrapper'></div>\n    <div class=\"mtfe-tip-mtfe-wrapper\" id=" + s.TIP_ID + '></div>\n    <div class="mtfe-model-mtfe-wrapper" id=' + s.MODEL_ID + '></div>\n    <div class="mtfe-mask-mtfe-wrapper" id=' + s.MASK_ID + '></div>\n    <div class="iLoginComp-wrapper ' + i.extraClass + '" id=' + s.COMP_INNER + ">\n      <div class='iLoginComp-phone-num-wrapper'>\n        <input class='iLoginComp-phone-num-input'\n          id=" + s.PHONE_NUM_INPUT_ID + "\n          type='text'\n          maxlength=11\n          " + (r ? "value=" + r : "") + "\n          placeholder=" + i.phoneNumPlaceholder + ">\n          " + (1 === i.sendCodePos ? '<div class="iLoginComp-send-verify-code-text" id=' + s.CODE_ID + ">" + i.sendCodeText + "</div>" : "<span></span>") + "\n      </div>\n      <div class='iLoginComp-verify-code-wrapper'>\n        <input class='iLoginComp-code-input'\n          id=" + s.CODE_INPUT_ID + "\n          type='text'\n          placeholder=" + i.codePlaceholder + ">\n          " + (2 === i.sendCodePos ? '<div class="iLoginComp-send-verify-code-text" id=' + s.CODE_ID + ">" + i.sendCodeText + "</div>" : "<span></span>") + "\n      </div>\n      <div class='iLogincomp-opbtn-wrapper'>\n        <button class='iLoginComp-cancel-btn-wrapper' id=" + s.CANCEL_LOGIN + " style=" + (i.showCancel ? "" : "display:none;") + ">\n          " + i.cancelBtnText + "\n        </button>\n        <button class='iLoginComp-login-btn-wrapper' id=" + s.LOGIN_ID + ">\n          " + i.loginBtnText + "\n        </button>\n      </div>\n    </div>\n  "), k.elementNodes = function (e) {
                var n = {};
                for (var o in e) e.hasOwnProperty(o) && (n[o] = document.getElementById(e[o]));
                return n
            }(k.idMap), k.bindEvents(), k.handlePhoneInput(Oe.phone_num), a.style.visibility = "visible", sn() && sn()._emit(nn.COMP_INITED)) : console.error("请在页面新建一个id为" + t + "的div容器!")
        }, this.bindEvents = function () {
            var e = Oe.isMobile ? "tap" : "click";
            n.addHandler(k.elementNodes.sendCodeBtn, "click", k.onSendCodeClick), n.addHandler(k.elementNodes.loginBtn, e, k.onLoginClick), n.addHandler(k.elementNodes.cancelBtn, e, k.onCancelClick), n.addHandler(k.elementNodes.phoneNumInput, "input", k.onPhoneNumInput), n.addHandler(k.elementNodes.codeInput, "input", k.onCodeInput), n.addHandler(k.elementNodes.mask, "click", k.onMaskClick)
        }, this.removeEvents = function () {
            var e = Oe.isMobile ? "tap" : "click";
            n.removeHandler(k.elementNodes.sendCodeBtn, "click", k.onSendCodeClick), n.removeHandler(k.elementNodes.loginBtn, e, k.onLoginClick), n.removeHandler(k.elementNodes.cancelBtn, e, k.onCancelClick), n.removeHandler(k.elementNodes.phoneNumInput, "input", k.onPhoneNumInput), n.removeHandler(k.elementNodes.codeInput, "input", k.onCodeInput), n.removeHandler(k.elementNodes.mask, "click", k.onMaskClick)
        }, this.clear = function () {
            k.removeEvents(), an.session = null
        }, this.showToast = function (e) {
            var n = e.msg, o = e.ele;
            !function (e) {
                if (e.msg) {
                    e.ele.innerHTML = e.msg;
                    var n = setTimeout(function () {
                        clearTimeout(n), n = null, e.ele.style.display = "none"
                    }, e.duration || 2e3);
                    e.ele.style.display = "block"
                }
            }({msg: n, ele: void 0 === o ? k.elementNodes.tip : o, duration: e.duration || 2e3})
        }, this.getLoginWay = function () {
            return k.urlQueryObj.ticket && "fail" === k.urlQueryObj.thirdLogin ? "H5" : "V3"
        }, this.onMaskClick = function () {
            "block" === k.elementNodes.yodaCode.style.display && (Ge(k.elementNodes.mask), k.elementNodes.yodaCode.innerHTML = "", k.canSendCode = !0)
        }, this.onSendCodeClick = function (e) {
            if (k.canSendCode) {
                var n = k.elementNodes.phoneNumInput.value;
                qe(n) ? (k.canSendCode = !1, sn() && sn()._emit(nn.SEND_SMSCODE_CLICK), k.loginApplyHandle(n)) : k.showToast({msg: "请输入正确的手机号"})
            }
        }, this.loginApplyHandle = function (i) {
            (function (e) {
                if ("V3" === k.getLoginWay()) {
                    var n = Oe.loginSource, o = Oe.campaignPlatform, t = Oe.allCampaignId;
                    return i = {
                        risk_platform: Oe.risk_platform,
                        risk_partner: Oe.risk_partner,
                        risk_app: Oe.risk_app,
                        risk_smsTemplateId: Oe.risk_smsTemplateId,
                        risk_smsPrefixId: Oe.risk_smsPrefixId,
                        uuid: Oe.uuid,
                        h5Fingerprint: Ke(window.location.href),
                        mobile: e,
                        loginSource: n,
                        campaignPlatform: o,
                        allCampaignId: t
                    }, r = i.uuid, a = i.risk_app, s = i.risk_platform, l = i.risk_partner, c = i.mobile, u = i.verifyLevel, d = void 0 === u ? 2 : u, p = i.specialRiskCode, f = i.risk_smsTemplateId, m = void 0 === f ? 0 : f, g = i.risk_smsPrefixId, h = void 0 === g ? 0 : g, v = i.h5Fingerprint, y = i.loginSource, b = i.campaignPlatform, C = i.allCampaignId, Ae(r).then(function (e) {
                        var n = {
                            uuid: e,
                            risk_app: a,
                            risk_platform: s,
                            risk_partner: l,
                            risk_smsTemplateId: m,
                            risk_smsPrefixId: h,
                            loginSource: y,
                            campaignPlatform: b,
                            allCampaignId: C,
                            sdkType: "h5"
                        }, o = {mobile: c, verifyLevel: d, h5Fingerprint: v};
                        return void 0 !== p && (o.specialRiskCode = p), _(Pe(_e.loginApplyUrl) + "?" + he(n), o).then(function (e) {
                            return console.log("mobileLoginApply res ==>", e), e
                        })
                    })
                }
                var i, r, a, s, l, c, u, d, p, f, m, g, h, v, y, b, C, w;
                return w = {
                    mobile: e,
                    st: k.urlQueryObj.ticket
                }, _("" + Pe(_e.h5LoginApplyUrl), w, null, !0).then(function (e) {
                    return console.log("h5LoginApply res ==>", e), e
                })
            })(i).then(function (e) {
                console.log("LoginApplyResponse", e), console.log("LoginApplyResponse2", JSON.stringify(e));
                var n, o = e.error;
                if (101190 === o.code) {
                    if (o.data) {
                        var t = o.data.requestCode;
                        (n = t, window.XDomainRequest ? C(Ee() + "?requestCode=" + n).then(function (e) {
                            return e
                        }) : _(Ee(), {requestCode: n}).then(function (e) {
                            return e
                        })).then(function (e) {
                            if (e && 1 === e.status) {
                                var n = {id: e.data.riskLevel, request_code: t, fingerprint: "", mobile: i};
                                k.action = e.data.action, k.extInfoParam = n, k.requestExtInfo(k.action, k.extInfoParam)
                            }
                        })
                    }
                } else k.showToast({msg: o.message}), k.canSendCode = !0
            }).catch(function (e) {
                console.error(e), k.canSendCode = !0, k.showToast({msg: "网络错误，请稍后重试！"})
            })
        }, this.yodaSucc = function () {
            console.log("smscode验证成功！"), k.requestExtInfo(k.action, k.extInfoParam), Xe({
                yodaEle: k.elementNodes.yodaCode,
                maskEle: k.elementNodes.mask
            })
        }, this.yodaFail = function (e) {
            console.log("smscode验证失败！"), console.log("options=====>", e), k.showToast({msg: "验证失败，请稍后重试！"}), k.canSendCode = !0, Xe({
                yodaEle: k.elementNodes.yodaCode,
                maskEle: k.elementNodes.mask
            })
        }, this.secYodaSuccCb = function (e) {
            var n = e.requestCode, o = e.responseCode;
            console.log("secYodaSuccCb"), k.elementNodes.innerLoginComp.style.display = "block", k.elementNodes.secYoda.innerHTML = "";
            var t, i = tn.userTicket;
            i && n && o && (t = {
                requestCode: n,
                responseCode: o,
                userTicket: i,
                h5Fingerprint: Ke(window.location.href),
                loginSource: Oe.loginSource,
                campaignPlatform: Oe.campaignPlatform,
                allCampaignId: Oe.allCampaignId,
                tokenVersion: Oe.tokenVersion
            }, Ae().then(function (n) {
                var e = {
                    loginSource: t.loginSource,
                    campaignPlatform: t.campaignPlatform,
                    allCampaignId: t.allCampaignId,
                    sdkType: "h5"
                }, o = {
                    setCookie: !0,
                    responseCode: t.responseCode,
                    userTicket: t.userTicket,
                    requestCode: t.requestCode,
                    h5Fingerprint: t.h5Fingerprint,
                    tokenVersion: t.tokenVersion
                };
                return _(Pe(_e.verifyloginUrl) + "?" + he(Re(e)), o, null, !0).then(function (e) {
                    return {uuid: n, res: e}
                })
            })).then(function (e) {
                e && !e.res.error ? sn() && sn()._emit(nn.LOGIN_COMPLETE, {
                    uuid: e.uuid,
                    user: e.res.user,
                    mobile: k.extInfoParam.mobile
                }) : k.showToast({msg: e.res.error.message})
            }).catch(function (e) {
                console.log(e), k.showToast({msg: "网络错误，请稍后重试！"})
            }), tn.userTicket = null
        }, this.secYodaFailCb = function (e) {
            console.log("二次验证失败", e);
            var n = "";
            switch (e && e.code) {
                case 121061:
                    n = "验证信息刷新次数过多，请24小时之后重试";
                    break;
                default:
                    n = "验证失败，请稍后重试！"
            }
            k.elementNodes.innerLoginComp.style.display = "block", k.elementNodes.secYoda.innerHTML = "", k.showToast({msg: n})
        }, this.requestExtInfo = function (e, n) {
            Qe(k.action, n).then(function (e) {
                if (1 === e.status) return k.showToast({msg: "验证码已发送"}), void k.showCountdown();
                var n = e.error;
                if (!n.request_code) return console.log(n.message), k.showToast({msg: n.message}), void (k.canSendCode = !0);
                var o = {
                    requestCode: n.request_code,
                    succCallbackFun: "yodaSuccCb",
                    failCallbackFun: "yodaFailCb",
                    root: s.YODA_SMS_VERIFY,
                    theme: "meituan",
                    isMobile: Oe.isMobile,
                    mounted: function () {
                        var e;
                        (e = {
                            yodaEle: k.elementNodes.yodaCode,
                            maskEle: k.elementNodes.mask
                        }).yodaEle.style.display = "block", Ve(e.maskEle)
                    }
                };
                ye() ? YodaSeed(o, ye()) : YodaSeed(o)
            })
        }, this.onLoginClick = function (e) {
            if (k.canLogin) {
                console.log("onLoginClick");
                var n = k.elementNodes.codeInput.value;
                k.extInfoParam && k.extInfoParam.request_code ? (sn() && sn()._emit(nn.LOGIN_CLICK), Je(k.action, o({}, k.extInfoParam, {smscode: n})).then(function (e) {
                    var n = e.status, o = e.error;
                    0 !== n ? k.loginHandler(e && e.data && e.data.response_code) : k.showToast({msg: o && o.message || "验证错误"})
                }).catch(function (e) {
                    console.log(e), k.showToast({msg: "网络错误，请稍后重试！"})
                })) : k.showToast({msg: "验证信息丢失，请重新发送验证码！"})
            }
        }, this.onCancelClick = function (e) {
            sn() && sn()._emit(nn.CANCEL_CLICK)
        }, this.loginHandler = function (e) {
            var n, o, t;
            if ("V3" === k.getLoginWay()) return (o = {
                risk_platform: Oe.risk_platform,
                risk_partner: Oe.risk_partner,
                risk_app: Oe.risk_app,
                uuid: Oe.uuid,
                loginSource: Oe.loginSource,
                campaignPlatform: Oe.campaignPlatform,
                allCampaignId: Oe.allCampaignId
            }, t = {
                tokenVersion: Oe.tokenVersion,
                requestCode: k.extInfoParam.request_code,
                mobile: k.extInfoParam.mobile,
                responseCode: e,
                h5Fingerprint: Ke(window.location.href)
            }, Ae(o.uuid).then(function (n) {
                o.uuid = n, o.sdkType = "h5";
                var e = Pe(_e.mobileLoginUrl) + "?" + he(Re(o));
                return t.setCookie = !0, _(e, t, null, !0).then(function (e) {
                    return {uuid: n, loginInfo: e}
                })
            })).then(function (e) {
                var n = e.loginInfo;
                if (n && n.error) {
                    var o = n.error, i = o.code, r = o.data;
                    !function (e) {
                        if (e.msg) {
                            var n = "\n    <div style='color: #333'>提示</div>\n    <div style='margin-top:1em;padding-bottom:1em;color: #888;font-size:.8em;'>" + e.msg + "</div>\n    <div style='padding-top:.5em;color:#06c1ae;border-top: 1px solid #e5e5e5;' id='iLoginComp-tip-id'>确定</div>\n  ";
                            e.ele.innerHTML = n, Ve(e.maskEle), document.getElementById("iLoginComp-tip-id").onclick = function () {
                                e.ele.style.display = "none", Ge(e.maskEle), e.cb && "function" == typeof e.cb && e.cb()
                            }.bind(window), e.ele.style.display = "block"
                        }
                    }({
                        msg: o.message, ele: k.elementNodes.model, cb: function () {
                            var e = r.param, n = r.userTicket;
                            tn.userTicket = n;
                            var o = en(e).requestCode;
                            if (101157 === i) {
                                var t = {
                                    requestCode: o,
                                    succCallbackFun: "secYodaSuccCb",
                                    failCallbackFun: "secYodaFailCb",
                                    root: s.YODA_SEC_VERIFY,
                                    theme: "meituan",
                                    isMobile: Oe.isMobile
                                };
                                ye() ? YodaSeed(t, ye()) : YodaSeed(t), k.elementNodes.innerLoginComp.style.display = "none"
                            }
                        }, maskEle: k.elementNodes.mask
                    })
                } else sn() && sn()._emit(nn.LOGIN_COMPLETE, {
                    uuid: e.uuid,
                    user: e.loginInfo.user,
                    mobile: k.extInfoParam.mobile
                })
            }).catch(function (e) {
                console.error(e), k.showToast({msg: "网络错误，请稍后重试！"})
            });
            (n = {
                responseCode: e,
                st: k.urlQueryObj.ticket,
                requestCode: k.extInfoParam.request_code
            }, _("" + Pe(_e.h5loginUrl), n, null, !0).then(function (e) {
                return console.log("h5Login loginInfo ==>", e), e
            })).then(function (e) {
                console.log(e), e && e.error ? k.showToast({msg: e.error.message}) : sn() && sn()._emit(nn.LOGIN_COMPLETE, {
                    user: e,
                    mobile: k.extInfoParam.mobile
                })
            }).catch(function (e) {
                console.error(e), k.showToast({msg: "网络错误，请稍后重试！"})
            })
        }, this.onPhoneNumInput = function (e) {
            var n = e.target.value;
            e.target.value = n.substr(0, 11), k.handlePhoneInput(n)
        }, this.handlePhoneInput = function (e) {
            11 <= e.length && qe(e) && !k.countdowning ? (t(k.elementNodes.sendCodeBtn, "iLogincomp-active") || i(k.elementNodes.sendCodeBtn, "iLogincomp-active"), k.canSendCode = !0) : (r(k.elementNodes.sendCodeBtn, "iLogincomp-active"), k.canSendCode = !1), k.toggleLoginBtn()
        }, this.onCodeInput = function (e) {
            var n = e.target.value;
            6 <= n.length && (e.target.value = n.substr(0, 6)), k.toggleLoginBtn()
        }, this.toggleLoginBtn = function () {
            var e;
            qe(k.elementNodes.phoneNumInput.value) && (e = k.elementNodes.codeInput.value, /^.{6}$/.test(e)) ? (k.canLogin = !0, t(k.elementNodes.loginBtn, "iLogincomp-active") || i(k.elementNodes.loginBtn, "iLogincomp-active")) : (k.canLogin = !1, r(k.elementNodes.loginBtn, "iLogincomp-active"))
        }, this.showCountdown = function () {
            k.countdowning = !0, r(k.elementNodes.sendCodeBtn, "iLogincomp-active"), k.elementNodes.sendCodeBtn.innerHTML = '<span class="iLogincomp-count-down"><span id="iLoginCounDown" ></span>s</span>', y(60, document.getElementById("iLoginCounDown")).then(function () {
                k.canSendCode = !0, k.countdowning = !1, i(k.elementNodes.sendCodeBtn, "iLogincomp-active"), k.elementNodes.sendCodeBtn.innerHTML = k.uiConfig.sendCodeText
            })
        }, this.isThirdEnv = function () {
            return He() || Ye()
        }, this.thirdLogin = function (e) {
            k.isThirdEnv() && "succ" !== k.urlQueryObj.thirdLogin && "fail" !== k.urlQueryObj.thirdLogin && k.getThirdLoginParam(e).then(function (e) {
                console.log("param=======>", he(e)), window.location.href = Pe(_e.h5authUrl) + "?" + he(e)
            })
        }, this.getThirdLoginParam = function (e) {
            return Se(e), Ae(Oe.uuid).then(function (e) {
                var n = {
                    platform: Oe.risk_platform,
                    partner: Oe.risk_partner,
                    specialRiskCode: Oe.specialRiskCode,
                    callbackUrl: Oe.callbackUrl,
                    callbackFailUrl: Oe.callbackFailUrl,
                    poiid: Oe.poiid,
                    officialAccount: Oe.officialAccount,
                    LONGITUDE: Oe.LONGITUDE,
                    LATITUDE: Oe.LATITUDE,
                    fromH5: 1,
                    version: 2,
                    thirdType: Ye() ? 1 : He() ? 2 : 0,
                    uuid: e
                };
                return Re(n)
            })
        }, this.urlQueryToObj = function (e) {
            return en(e)
        }, this.idMap = {
            innerLoginComp: s.COMP_INNER,
            sendCodeBtn: s.CODE_ID,
            loginBtn: s.LOGIN_ID,
            phoneNumInput: s.PHONE_NUM_INPUT_ID,
            codeInput: s.CODE_INPUT_ID,
            tip: s.TIP_ID,
            yodaCode: s.YODA_SMS_VERIFY,
            secYoda: s.YODA_SEC_VERIFY,
            mask: s.MASK_ID,
            cancelBtn: s.CANCEL_LOGIN,
            model: s.MODEL_ID
        }, this.elementNodes = {}, this.canSendCode = !1, this.countdowning = !1, this.session = (e = new rn, an.session = e, an.session), this.urlQueryObj = this.urlQueryToObj(window.location.search.substring(1)), this.action = "V3" === this.getLoginWay() ? "login" : "thirdlogin"
    }, cn = "undefined" != typeof window;
    return ln.load = function () {
        cn && (window.iLoginComp = ln, window.yodaSuccCb = function () {
            return window.iLoginComp.yodaSucc()
        }, window.yodaFailCb = function (e) {
            return window.iLoginComp.yodaFail(e)
        }, window.secYodaSuccCb = function (e) {
            return window.iLoginComp.secYodaSuccCb(e)
        }, window.secYodaFailCb = function (e) {
            return window.iLoginComp.secYodaFailCb(e)
        }, window.Rohr_Opt = {geo: !1})
    }, ln.load(), ln
});

